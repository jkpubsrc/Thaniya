


import os
import typing

import jk_typing





#
# This is a lock file. As long as it is open, the current file system is blocked against unmounting.
#
class LockFile(object):

	################################################################################################################################
	## Constructor
	################################################################################################################################

	#
	# Constructor method.
	#
	@jk_typing.checkFunctionSignature()
	def __init__(self, filePath:str):
		self.__filePath = filePath
		self.__f = None		# we need that; if the next statement raises an exception __del__() might be called - and fail because there might otherwise be no self.__f
		self.__f = open(self.__filePath, "w")
	#

	################################################################################################################################
	## Public Properties
	################################################################################################################################

	@property
	def filePath(self) -> str:
		return self.__filePath
	#

	################################################################################################################################
	## Helper Methods
	################################################################################################################################

	################################################################################################################################
	## Public Methods
	################################################################################################################################

	def __del__(self):
		if self.__f:
			self.__f.close()
			self.__f = None
			os.unlink(self.__filePath)
	#

	def discard(self):
		if self.__f:
			self.__f.close()
			self.__f = None
			os.unlink(self.__filePath)
	#

	################################################################################################################################
	## Static Methods
	################################################################################################################################

#









